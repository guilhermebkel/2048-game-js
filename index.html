<!DOCTYPE html>
<html>
	<head>
		<title>2048 Game</title>

		<style>
			.board {
				width: 500px;
				height: 500px;

				background-color: #B8ADA1;

				display: grid;
				grid-template-columns: 1fr 1fr 1fr 1fr;
				grid-template-rows: 1fr 1fr 1fr 1fr;
				grid-gap: 8px;

				padding: 8px;
			}

			.square {
				background-color: #CAC0B5;
				
				display: flex;
				justify-content: center;
				align-items: center;

				font-size: 48px;
				font-weight: bolder;
			}
		</style>
	</head>
	<body>
		<div class="board">
			<div class="square">

			</div>

			<div class="square">

			</div>

			<div class="square">

			</div>

			<div class="square">

			</div>

			<div class="square">
				2
			</div>

			<div class="square">
				2
			</div>

			<div class="square">
				2
			</div>

			<div class="square">

			</div>

			<div class="square">

			</div>

			<div class="square">

			</div>

			<div class="square">

			</div>

			<div class="square">

			</div>

			<div class="square">

			</div>

			<div class="square">

			</div>

			<div class="square">

			</div>

			<div class="square">

			</div>
		</div>

		<script>
			const MAX_AMOUNT = 4

			const squareElements = document.getElementsByClassName("square")

			const table = []

			for (let row = 0; row < MAX_AMOUNT; row++) {
				table[row] = []

				for (let column = 0; column < MAX_AMOUNT; column++) {
					const squareElementIndex = ((MAX_AMOUNT * row) + column)

					table[row][column] = squareElements[squareElementIndex]
				}
			}

			window.addEventListener("keydown", async function(event) {
				// ArrowRight, ArrowUp, ArrowLeft, ArrowDown
				const keyPressed = event.key

				if (keyPressed === "ArrowRight") {
					for (let targetColumn = MAX_AMOUNT - 1; targetColumn >= 0; targetColumn--) {
						const initialTargetSquareElement = table[1][targetColumn]

						let currentTargetSquarePosition = targetColumn

						for (let columnToCompare = MAX_AMOUNT - 1; columnToCompare >= 0; columnToCompare--) {
							const squareToCompareElement = table[1][columnToCompare]
							const currentTargetSquareElement = table[1][currentTargetSquarePosition]

							if (targetColumn === columnToCompare) {
								continue
							}

							const isTargetSquareElementMovable = initialTargetSquareElement.innerText && !squareToCompareElement.innerText
							const areSquareValuesEqual = currentTargetSquareElement.innerText === squareToCompareElement.innerText
							const areSquareValuesValid = currentTargetSquareElement.innerText && squareToCompareElement.innerText

							if ((columnToCompare <= targetColumn) && areSquareValuesEqual && areSquareValuesValid) {
								currentTargetSquareElement.innerText = Number(currentTargetSquareElement.innerText) + Number(squareToCompareElement.innerText)

								squareToCompareElement.innerText = ""

								break
							}

							if ((columnToCompare >= targetColumn) && isTargetSquareElementMovable) {
								squareToCompareElement.innerText = initialTargetSquareElement.innerText

								currentTargetSquarePosition = columnToCompare

								initialTargetSquareElement.innerText = ""
							}
						}
					}
				}
			})
		</script>
	</body>
</html>