<!DOCTYPE html>
<html>
	<head>
		<title>2048 Game</title>

		<style>
			.board {
				width: 500px;
				height: 500px;

				background-color: #B8ADA1;

				display: grid;
				grid-template-columns: 1fr 1fr 1fr 1fr;
				grid-template-rows: 1fr 1fr 1fr 1fr;
				grid-gap: 8px;

				padding: 8px;
			}

			.square {
				background-color: #CAC0B5;
				
				display: flex;
				justify-content: center;
				align-items: center;

				font-size: 48px;
				font-weight: bolder;
			}
		</style>
	</head>
	<body>
		<div class="board">
			<div class="square">

			</div>

			<div class="square">

			</div>

			<div class="square">

			</div>

			<div class="square">

			</div>

			<div class="square">
				2
			</div>

			<div class="square">
				2
			</div>

			<div class="square">
				2
			</div>

			<div class="square">

			</div>

			<div class="square">

			</div>

			<div class="square">

			</div>

			<div class="square">

			</div>

			<div class="square">

			</div>

			<div class="square">

			</div>

			<div class="square">

			</div>

			<div class="square">

			</div>

			<div class="square">

			</div>
		</div>

		<script>
			const MAX_AMOUNT = 4

			const squareElements = document.getElementsByClassName("square")

			const table = []

			for (let row = 0; row < MAX_AMOUNT; row++) {
				table[row] = []

				for (let column = 0; column < MAX_AMOUNT; column++) {
					const squareElementIndex = ((MAX_AMOUNT * row) + column)

					table[row][column] = squareElements[squareElementIndex]
				}
			}

			window.addEventListener("keydown", async function(event) {
				// ArrowRight, ArrowUp, ArrowLeft, ArrowDown
				const keyPressed = event.key

				if (keyPressed === "ArrowRight") {
					for (let targetColumn = MAX_AMOUNT - 1; targetColumn >= 0; targetColumn--) {
						for (let columnToCompare = MAX_AMOUNT - 1; columnToCompare >= 0; columnToCompare--) {

							if (targetColumn === columnToCompare) {
								break
							}

							await new Promise(resolve => setTimeout(resolve, 55))

							if (table[1][targetColumn].innerText && !table[1][columnToCompare].innerText) {
								table[1][columnToCompare].innerText = table[1][targetColumn].innerText

								table[1][targetColumn].innerText = ""
							}

							console.log(columnToCompare, targetColumn, table[1][targetColumn].innerText, table[1][columnToCompare].innerText)
							if ((columnToCompare <= targetColumn) && (table[1][targetColumn].innerText === table[1][columnToCompare].innerText)) {
								table[1][targetColumn].innerText = table[1][targetColumn].innerText + table[1][columnToCompare].innerText

								break
							}
						}
					}
				}
			})
		</script>
	</body>
</html>